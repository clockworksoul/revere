{{template "_header.html" .}}
<h1>{{if .Monitor}}Edit{{else}}New{{end}} Monitor</h1>
<div id="js-errors">
  <div class="js-error alert alert-danger hidden"></div>
</div>
<form id="js-monitor-form" action="/monitors/new/edit" class="form-horizontal" method="POST">
  {{/* Basic Monitor Info */}}
  <div id="js-monitor-info">
    <input type="hidden" class="form-control" data-json-type="Number" name="id" value="{{.Monitor.Id}}">
    <div class="form-group">
      <label class="col-sm-2 control-label" for="name">Name</label>
      <div class="col-sm-10">
        <input id="name" type="text" class="form-control" name="name" value="{{.Monitor.Name}}">
      </div>
    </div>
    <div class="form-group">
      <label class="col-sm-2 control-label" for="owner">Owner</label>
      <div class="col-sm-10">
        <input id="owner" type="text" class="form-control" name="owner" value="{{.Monitor.Owner}}">
      </div>
    </div>
    <div class="form-group">
      <label class="col-sm-2 control-label" for="description">Description</label>
      <div class="col-sm-10">
        <textarea id="description" class="form-control" rows="4" name="description">{{.Monitor.Description}}</textarea>
      </div>
    </div>
    <div class="form-group">
      <label class="col-sm-2 control-label" for="response">Alert response</label>
      <div class="col-sm-10">
        <textarea id="response" class="form-control" rows="4" name="response">{{.Monitor.Response}}</textarea>
      </div>
    </div>
    <div class="form-group">
      <label class="col-sm-2 control-label" for="probeType">Probe</label>
      <div class="col-sm-10">
        <select id="#js-probe-type" class="form-control" data-json-type="Number" name="probeType">
          {{range probes}}
            <option value="{{.Id}}" {{if strEq $.Monitor.Probe.ProbeType.Id .Id}}selected{{end}}>{{.Name}}</option>
          {{end}}
        </select>
      </div>
    </div>
  </div>
  {{/* Probe */}}
  <div id="js-probe">
    {{.Monitor.ProbeTemplate}}
  </div>
  {{/* Triggers */}}
  <h2>Triggers</h2>
  <div id="triggers">
    {{range .Monitor.Triggers}}
      {{template "_triggers.html" .}}
    {{else}}
      {{template "_triggers.html"}}
    {{end}}
    <div class="form-group">
      <button id="js-add-trigger" class="btn btn-default">+ Add</button>
    </div>
  </div>
  <div class="form-group">
    <input type="submit" class="btn-lg btn-success" value="Save">
  </div>
</form>
{{define "MoreScripts"}}
  <script type="text/javascript" src="/static/js/helpers.js"></script>
  <script type="text/javascript" src="/static/js/monitors-edit.js"></script>
  <script type="text/javascript">
    $(document).ready(function() {
      monitorsEdit.init();
    });
  </script>
  {{range targetScripts}}
    <script type="text/javascript" src="{{.}}"></script>
  {{end}}
{{end}}
{{template "_footer.html"}}
